{"version":3,"sources":["../source/Tooltip.js"],"names":["React","PureComponent","PropTypes","ReactDOM","classNames","Tooltip","show","bind","hide","on_mouse_enter","on_mouse_leave","on_touch_start","mobile","document","tooltip","createElement","style","display","position","left","top","classList","add","textContent","props","text","container","appendChild","parentNode","removeChild","hide_timeout","clearTimeout","undefined","show_timeout","body","width","offsetWidth","height","offsetHeight","origin","findDOMNode","origin_width","_offset","offset","reposition_within_screen","animate","remove","coordinates","calculate_coordinates","x","y","hidingAnimationDuration","setTimeout","delay","className","children","markup","ref","hovered_element_wrapper_style","propTypes","string","isRequired","number","func","defaultProps","minimal_margin","window","innerWidth","pageYOffset","innerHeight","element","rect","getBoundingClientRect","client_left","clientLeft","client_top","clientTop","pageXOffset"],"mappings":"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","file":"Tooltip.js","sourcesContent":["import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\nimport ReactDOM from 'react-dom'\nimport classNames from 'classnames'\n\n// https://github.com/Dogfalo/materialize/blob/master/js/tooltip.js\nexport default class Tooltip extends PureComponent\n{\n\tstatic propTypes =\n\t{\n\t\t// Tooltip text\n\t\ttext : PropTypes.string.isRequired,\n\n\t\t// The delay before the tooltip is shown (in milliseconds)\n\t\tdelay : PropTypes.number.isRequired,\n\n\t\t// The duration of the tooltip hiding animation.\n\t\t// The DOM element will retain `display: block` for this time period.\n\t\t// When changing this timeout also change `transition` time for\n\t\t// `.tooltip--after-show` and `.tooltip--before-hide` CSS classes.\n\t\t// Is `120` by default.\n\t\thidingAnimationDuration : PropTypes.number.isRequired,\n\n\t\t// `container` property is optional (it's `document.body` by default)\n\t\tcontainer : PropTypes.func\n\t}\n\n\tstatic defaultProps =\n\t{\n\t\tdelay : 200, // in milliseconds\n\t\thidingAnimationDuration : 120 // in milliseconds\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper()\n\n\t\tthis.show = this.show.bind(this)\n\t\tthis.hide = this.hide.bind(this)\n\n\t\tthis.on_mouse_enter = this.on_mouse_enter.bind(this)\n\t\tthis.on_mouse_leave = this.on_mouse_leave.bind(this)\n\t\tthis.on_touch_start = this.on_touch_start.bind(this)\n\n\t\tthis.mobile = false\n\t}\n\n\tcomponentWillMount()\n\t{\n\t\t// Don't render tooltip on server side\n\t\tif (typeof document === 'undefined')\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tthis.tooltip = document.createElement('div')\n\n\t\tthis.tooltip.style.display = 'none'\n\t\tthis.tooltip.style.position = 'absolute'\n\t\tthis.tooltip.style.left = 0\n\t\tthis.tooltip.style.top = 0\n\n\t\tthis.tooltip.classList.add('rrui__tooltip')\n\n\t\tthis.tooltip.textContent = this.props.text\n\n\t\tthis.container().appendChild(this.tooltip)\n\t}\n\n\tcomponentWillUnmount()\n\t{\n\t\t// Won't throw an exception\n\t\tthis.tooltip.parentNode.removeChild(this.tooltip)\n\n\t\tif (this.hide_timeout)\n\t\t{\n\t\t\tclearTimeout(this.hide_timeout)\n\t\t\tthis.hide_timeout = undefined\n\t\t}\n\n\t\tif (this.show_timeout)\n\t\t{\n\t\t\tclearTimeout(this.show_timeout)\n\t\t\tthis.show_timeout = undefined\n\t\t}\n\t}\n\n\tcontainer()\n\t{\n\t\treturn (this.props.container && this.props.container()) || document.body\n\t}\n\n\tcalculate_coordinates()\n\t{\n\t\tconst width  = this.tooltip.offsetWidth\n\t\tconst height = this.tooltip.offsetHeight\n\n\t\tconst origin = ReactDOM.findDOMNode(this.origin)\n\n\t\tconst origin_width  = origin.offsetWidth\n\t\t// const origin_height = origin.offsetHeight\n\n\t\tconst _offset = offset(origin)\n\n\t\tconst top  = _offset.top - height - offset(this.container()).top\n\t\tconst left = _offset.left + origin_width / 2 - width / 2\n\n\t\treturn reposition_within_screen(left, top, width, height)\n\t}\n\n\tshow()\n\t{\n\t\t// Play tooltip showing animation\n\t\tlet animate = false\n\n\t\t// If hiding animation is being played,\n\t\t// then cancel it, and cancel setting\n\t\t// `display` to `none` after it finishes playing.\n\t\tif (this.hide_timeout)\n\t\t{\n\t\t\tclearTimeout(this.hide_timeout)\n\t\t\tthis.hide_timeout = undefined\n\n\t\t\t// Abort tooltip hiding animation.\n\t\t\t// It will automatically return to the \"showing\" state.\n\t\t\tthis.tooltip.classList.remove('rrui__tooltip--before-hide')\n\t\t}\n\t\t// Otherwise, the tooltip is hidden (or never been shown)\n\t\telse\n\t\t{\n\t\t\tthis.tooltip.style.display = 'block'\n\n\t\t\t// Play tooltip showing animation\n\t\t\tanimate = true\n\t\t}\n\n\t\tconst coordinates = this.calculate_coordinates()\n\t\t// console.log(coordinates)\n\n\t\tthis.tooltip.style.left = coordinates.x + 'px'\n\t\tthis.tooltip.style.top  = coordinates.y + 'px'\n\n\t\t// Play tooltip showing animation\n\t\t// (doing it after setting position because\n\t\t//  setting position applies `display: block`)\n\t\tif (animate)\n\t\t{\n\t\t\tthis.tooltip.classList.add('rrui__tooltip--after-show')\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tconst { hidingAnimationDuration } = this.props\n\n\t\t// If already hiding, or if already hidden, then do nothing.\n\t\tif (this.hide_timeout || this.tooltip.style.display === 'none')\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\t// Play tooltip hiding animation\n\t\tthis.tooltip.classList.add('rrui__tooltip--before-hide')\n\n\t\t// Set the tooltip to `display: none`\n\t\t// after its hiding animation finishes.\n\t\tthis.hide_timeout = setTimeout(() =>\n\t\t{\n\t\t\tthis.hide_timeout = undefined\n\t\t\tthis.tooltip.style.display = 'none'\n\n\t\t\tthis.tooltip.classList.remove('rrui__tooltip--before-hide')\n\t\t\tthis.tooltip.classList.remove('rrui__tooltip--after-show')\n\t\t},\n\t\thidingAnimationDuration)\n\t}\n\n\ton_mouse_enter()\n\t{\n\t\t// mouse enter and mouse leave events\n\t\t// are triggered on mobile devices too\n\t\tif (this.mobile)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\t// Shouldn't happen, because\n\t\t// `mouse leave` event clears this timeout.\n\t\tif (this.show_timeout)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst { delay } = this.props\n\n\t\t// Don't show the tooltip immediately\n\t\t// but rather wait for the user to\n\t\t// \"mouse over\" it for a short time interval.\n\t\t// (prevents false positives)\n\t\tthis.show_timeout = setTimeout(() =>\n\t\t{\n\t\t\tthis.show_timeout = undefined\n\t\t\tthis.show()\n\t\t},\n\t\tdelay)\n\t}\n\n\ton_mouse_leave()\n\t{\n\t\t// mouse enter and mouse leave events\n\t\t// are triggered on mobile devices too\n\t\tif (this.mobile)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\t// If tooltip hasn't been shown yet,\n\t\t// then cancel showing it.\n\t\tif (this.show_timeout)\n\t\t{\n\t\t\tclearTimeout(this.show_timeout)\n\t\t\tthis.show_timeout = undefined\n\t\t\treturn\n\t\t}\n\n\t\t// Otherwise, the tooltip is shown, so hide it.\n\t\tthis.hide()\n\t}\n\n\ton_touch_start()\n\t{\n\t\t// mouse enter events won't be processed from now on\n\t\tthis.mobile = true\n\n\t\tthis.show()\n\t}\n\n\trender()\n\t{\n\t\t// Shows tooltip on mouse over when on desktop.\n\t\t// Shows tooltip on touch when on mobile.\n\n\t\tconst { style, className, children } = this.props\n\n\t\tconst markup =\n\t\t(\n\t\t\t<div\n\t\t\t\tref={ ref => this.origin = ref }\n\t\t\t\tonMouseEnter={ this.on_mouse_enter }\n\t\t\t\tonMouseLeave={ this.on_mouse_leave }\n\t\t\t\tonTouchStart={ this.on_touch_start }\n\t\t\t\tonTouchMove={ this.hide }\n\t\t\t\tonTouchEnd={ this.hide }\n\t\t\t\tonTouchCancel={ this.hide }\n\t\t\t\tstyle={ style ? { ...hovered_element_wrapper_style, ...style } : hovered_element_wrapper_style }\n\t\t\t\tclassName={ classNames('rrui__tooltip__target', className) }>\n\t\t\t\t{ children }\n\t\t\t</div>\n\t\t)\n\n\t\treturn markup\n\t}\n}\n\nfunction reposition_within_screen(x, y, width, height)\n{\n\tconst minimal_margin = 4 // in pixels\n\n\tif (x < minimal_margin)\n\t{\n\t\tx = minimal_margin\n\t}\n\telse if (x + width + minimal_margin > window.innerWidth)\n\t{\n\t\tx -= (x + width + minimal_margin) - window.innerWidth\n\t}\n\n\tif (y < window.pageYOffset + minimal_margin)\n\t{\n\t\ty = window.pageYOffset + minimal_margin\n\t}\n\telse if (y + height + minimal_margin > window.pageYOffset + window.innerHeight)\n\t{\n\t\ty -= (y + height + minimal_margin) - (window.pageYOffset + window.innerHeight)\n\t}\n\n\treturn { x, y }\n}\n\n// http://stackoverflow.com/questions/5598743/finding-elements-position-relative-to-the-document\nfunction offset(element)\n{\n\tconst rect = element.getBoundingClientRect()\n\n\tconst client_left = document.clientLeft || document.body.clientLeft || 0\n\tconst client_top  = document.clientTop || document.body.clientTop || 0\n\n\tconst top  = rect.top + window.pageYOffset - client_top\n\tconst left = rect.left + window.pageXOffset - client_left\n\n\treturn { top, left }\n}\n\nconst hovered_element_wrapper_style =\n{\n\tdisplay: 'inline-block'\n}"]}