{"version":3,"sources":["../source/TextInput.js"],"names":["Text_input","state","autoresize","event","props","measurements","element","target","findDOMNode","input","style","height","scrollHeight","extra_height","Math","max","initial_height","ceil","on_window_resize","on_change","value","undefined","onChange","on_key_down","onKeyDown","ctrlKey","metaKey","keyCode","preventDefault","multiline","fallback","window","addEventListener","setState","javascript","removeEventListener","id","name","placeholder","label","labelStyle","disabled","required","floatingLabel","className","label_floats","markup","render_input","should_indicate_invalid","is_empty","render_error_message","render_static","options","ref","focus","inputStyle","rows","cols","tabIndex","onFocus","onBlur","input_style","resize","properties","autoFocus","type","get_input_type","error","email","password","trim","indicateInvalid","autoresize_measure","measure","propTypes","string","oneOfType","number","func","isRequired","bool","object","defaultProps","getComputedStyle","parseInt","borderTopWidth","borderBottomWidth","non_rounded_initial_height","getBoundingClientRect"],"mappings":"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","file":"TextInput.js","sourcesContent":["import React, { PureComponent, createElement } from 'react'\nimport PropTypes from 'prop-types'\nimport ReactDOM from 'react-dom'\nimport classNames from 'classnames'\nimport throttle from 'lodash/throttle'\n\nimport { submit_parent_form } from './utility/dom'\nimport { get_modular_grid_unit } from './utility/grid'\n\nexport default class Text_input extends PureComponent\n{\n\tstate = {}\n\n\tstatic propTypes =\n\t{\n\t\t// Text field label\n\t\tlabel            : PropTypes.string,\n\n\t\t// HTML form input `name` attribute\n\t\tname             : PropTypes.string,\n\n\t\t// Text field value\n\t\tvalue            : PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n\n\t\t// Is called when the `value` is edited\n\t\tonChange         : PropTypes.func.isRequired,\n\n\t\t// Disables the text field\n\t\tdisabled         : PropTypes.bool,\n\n\t\t// Renders an error message below the `<input/>`\n\t\terror            : PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n\n\t\t// If this flag is `true` then the `error` is shown.\n\t\t// If this flag is `false` then the `error` is not shown (even if passed).\n\t\tindicateInvalid  : PropTypes.bool,\n\n\t\t// Set to `true` to mark the field as required\n\t\trequired         : PropTypes.bool.isRequired,\n\n\t\t// `<input/>` placeholder\n\t\tplaceholder      : PropTypes.string,\n\n\t\t// Set to `false` to prevent the `<label/>` from floating\n\t\tfloatingLabel    : PropTypes.bool.isRequired,\n\n\t\t// `<textarea/>` instead of an `<input type=\"text\"/>`\n\t\tmultiline        : PropTypes.bool,\n\n\t\t// Sets HTML input `type` attribute to `email`\n\t\temail            : PropTypes.bool,\n\n\t\t// Sets HTML input `type` attribute to `password`\n\t\tpassword         : PropTypes.bool,\n\n\t\t// A manually specified `type` attribute\n\t\ttype             : PropTypes.string.isRequired,\n\n\t\t// Whether `<textarea/>` should autoresize itself\n\t\t// (is `true` by default)\n\t\tautoresize       : PropTypes.bool.isRequired,\n\n\t\t// Autofocuses the input field\n\t\tfocus            : PropTypes.bool,\n\n\t\t// HTML `tabindex` attribute\n\t\ttabIndex         : PropTypes.number,\n\n\t\t// `<textarea/>` `rows` attribute (row count, i.e. height)\n\t\trows             : PropTypes.number,\n\n\t\t// `<textarea/>` `cols` attribute (column count, i.e. width)\n\t\tcols             : PropTypes.number,\n\n\t\t// A custom `input` component can be passed\n\t\tinput            : PropTypes.oneOfType([PropTypes.func, PropTypes.string]).isRequired,\n\n\t\t// (exotic use case)\n\t\t// Falls back to a plain HTML input\n\t\t// when javascript is disabled (e.g. Tor)\n\t\tfallback         : PropTypes.bool.isRequired,\n\n\t\t// Is called when the input is focused\n\t\tonFocus          : PropTypes.func,\n\n\t\t// `onKeyDown` event handler\n\t\tonKeyDown        : PropTypes.func,\n\n\t\t// Is called when the input is blurred\n\t\tonBlur           : PropTypes.func,\n\n\t\t// CSS style object\n\t\tstyle            : PropTypes.object,\n\n\t\t// CSS name\n\t\tclassName        : PropTypes.string,\n\n\t\t// CSS style object for `<input/>`\n\t\tinputStyle       : PropTypes.object,\n\n\t\t// CSS style object for the label\n\t\tlabelStyle       : PropTypes.object\n\t}\n\n\tstatic defaultProps =\n\t{\n\t\t// HTML input `type` attribute\n\t\ttype : 'text',\n\n\t\t// `<textarea/>` should autoresize itself\n\t\tautoresize : true,\n\n\t\t// Set to `false` to prevent the `<label/>` from floating\n\t\tfloatingLabel : true,\n\n\t\t// Javascriptless users support (e.g. Tor)\n\t\tfallback : false,\n\n\t\t// Set to `true` to mark the field as required\n\t\trequired : false,\n\n\t\t// Render an `<input/>` by default\n\t\tinput: 'input'\n\t}\n\n\t// Client side rendering, javascript is enabled\n\tcomponentDidMount()\n\t{\n\t\tconst { multiline, fallback, value, autoresize } = this.props\n\n\t\t// Doing `this.measure()` here now\n\t\t// because `<textarea/>` should autoresize\n\t\t// in case its `value` is set up front.\n\t\t// // Not doing `this.measure()` here because\n\t\t// // that resulted in weird `<textarea/>` height mismatch.\n\t\t// // Measuring the height of `<textarea/>` during\n\t\t// // the first `this.measurements()` call instead.\n\n\t\tif (value && autoresize)\n\t\t{\n\t\t\tthis.autoresize()\n\t\t}\n\n\t\tif (multiline)\n\t\t{\n\t\t\twindow.addEventListener('resize', this.on_window_resize)\n\t\t}\n\n\t\tif (fallback)\n\t\t{\n\t\t\tthis.setState({ javascript: true })\n\t\t}\n\t}\n\n\tcomponentWillUnmount()\n\t{\n\t\tconst { multiline } = this.props\n\n\t\tif (multiline)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.on_window_resize)\n\t\t}\n\t}\n\n\trender()\n\t{\n\t\tconst\n\t\t{\n\t\t\tid,\n\t\t\tname,\n\t\t\tvalue,\n\t\t\tplaceholder,\n\t\t\tlabel,\n\t\t\tlabelStyle,\n\t\t\tmultiline,\n\t\t\tfallback,\n\t\t\tdisabled,\n\t\t\trequired,\n\t\t\tfloatingLabel,\n\t\t\tstyle,\n\t\t\tclassName\n\t\t}\n\t\t= this.props\n\n\t\tconst label_floats = placeholder === undefined && floatingLabel\n\n\t\tconst markup =\n\t\t(\n\t\t\t<div\n\t\t\t\tstyle={ style }\n\t\t\t\tclassName={ classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__text-input',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__rich' : fallback\n\t\t\t\t\t},\n\t\t\t\t\tclassName\n\t\t\t\t) }>\n\n\t\t\t\t{/* `<input/>` and its `<label/>` */}\n\t\t\t\t<div\n\t\t\t\t\tclassName={ classNames('rrui__input',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__input--multiline' : multiline,\n\t\t\t\t\t}) }>\n\n\t\t\t\t\t{/* `<input/>` */}\n\t\t\t\t\t{ this.render_input({ name: false }) }\n\n\t\t\t\t\t{/* Input `<label/>`. */}\n\t\t\t\t\t{/* It is rendered after the input to utilize the\n\t\t\t\t       `input:focus + label` CSS selector rule */}\n\t\t\t\t\t{ label &&\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor={ id }\n\t\t\t\t\t\t\tclassName={ classNames('rrui__input-label',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t\t\t'rrui__input-label--invalid'           : this.should_indicate_invalid(),\n\t\t\t\t\t\t\t\t'rrui__input-label--floating'          : label_floats,\n\t\t\t\t\t\t\t\t'rrui__input-label--required'          : required && this.is_empty(),\n\t\t\t\t\t\t\t\t'rrui__text-input__label--placeholder' : label_floats && this.is_empty()\n\t\t\t\t\t\t\t}) }\n\t\t\t\t\t\t\tstyle={ labelStyle }>\n\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t</label>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Error message */}\n\t\t\t\t{ this.should_indicate_invalid() && this.render_error_message() }\n\n\t\t\t\t{/* Fallback in case javascript is disabled (no animated <label/>) */}\n\t\t\t\t{ fallback && !this.state.javascript && this.render_static() }\n\t\t\t</div>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\trender_input(options = {})\n\t{\n\t\tconst { placeholder, ref, name } = options\n\n\t\tconst\n\t\t{\n\t\t\tvalue,\n\t\t\tmultiline,\n\t\t\tfocus,\n\t\t\tonChange,\n\t\t\tdisabled,\n\t\t\tinputStyle,\n\t\t\trows,\n\t\t\tcols,\n\t\t\ttabIndex,\n\t\t\tautoresize,\n\n\t\t\t// A custom input component\n\t\t\t// (e.g. for an `input-format` text input, like a phone number)\n\t\t\tinput,\n\n\t\t\t// Passthrough properties\n\t\t\tid,\n\t\t\tonFocus,\n\t\t\tonBlur\n\t\t}\n\t\t= this.props\n\n\t\tlet input_style = inputStyle\n\n\t\tif (multiline && autoresize)\n\t\t{\n\t\t\tinput_style =\n\t\t\t{\n\t\t\t\tresize : 'none',\n\t\t\t\t...inputStyle\n\t\t\t}\n\t\t}\n\n\t\tconst properties =\n\t\t{\n\t\t\tid,\n\t\t\tname        : name === false ? undefined : this.props.name,\n\t\t\tref         : ref === false ? undefined : ref => this.input = ref,\n\t\t\tvalue       : (value === undefined || value === null) ? '' : value,\n\t\t\tplaceholder : placeholder || this.props.placeholder,\n\t\t\tonChange    : this.on_change,\n\t\t\tonKeyDown   : this.on_key_down,\n\t\t\tonFocus,\n\t\t\tonBlur,\n\t\t\tdisabled,\n\t\t\tclassName   : classNames('rrui__input-element', 'rrui__input-field', 'rrui__text-input__input',\n\t\t\t{\n\t\t\t\t'rrui__input-field--invalid'         : this.should_indicate_invalid(),\n\t\t\t\t// CSS selector performance optimization\n\t\t\t\t'rrui__text-input__input--empty'     : this.is_empty(),\n\t\t\t\t'rrui__text-input__input--invalid'   : this.should_indicate_invalid(),\n\t\t\t\t'rrui__text-input__input--disabled'  : disabled,\n\t\t\t\t'rrui__text-input__input--multiline' : multiline\n\t\t\t}),\n\t\t\tstyle       : input_style,\n\t\t\tautoFocus   : focus,\n\t\t\ttabIndex\n\t\t}\n\n\t\t// In case of `multiline` set to `true`\n\t\t// this is gonna be a `<textarea/>`\n\t\tif (multiline)\n\t\t{\n\t\t\t// \"keyup\" is required for IE to properly reset height when deleting text\n\t\t\treturn <textarea\n\t\t\t\trows={ rows }\n\t\t\t\tcols={ cols }\n\t\t\t\tonInput={ this.autoresize }\n\t\t\t\tonKeyUp={ this.autoresize }\n\t\t\t\t{ ...properties }/>\n\t\t}\n\n\t\t// Add `<input/>` `type` to properties\n\t\tproperties.type = this.get_input_type()\n\n\t\t// If a custom `input` component was passed then use it.\n\t\t// Otherwise use a simple `<input/>`.\n\t\treturn createElement(input, properties)\n\t}\n\n\trender_error_message()\n\t{\n\t\tconst { error } = this.props\n\n\t\treturn <div className=\"rrui__input-error\">{ error }</div>\n\t}\n\n\t// Fallback in case javascript is disabled (no animated <label/>)\n\trender_static()\n\t{\n\t\tconst { label } = this.props\n\n\t\tconst markup =\n\t\t(\n\t\t\t<div className=\"rrui__rich__fallback\">\n\t\t\t\t{/* <input/> */}\n\t\t\t\t{ this.render_input({ placeholder: label, ref: false }) }\n\n\t\t\t\t{/* Error message */}\n\t\t\t\t{ this.should_indicate_invalid() && this.render_error_message() }\n\t\t\t</div>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\t// \"text\", \"email\", \"password\", etc\n\tget_input_type()\n\t{\n\t\tconst { type, email, password } = this.props\n\n\t\tif (email)\n\t\t{\n\t\t\treturn 'email'\n\t\t}\n\n\t\tif (password)\n\t\t{\n\t\t\treturn 'password'\n\t\t}\n\n\t\treturn type\n\t}\n\n\t// Whether the input is empty\n\tis_empty()\n\t{\n\t\tconst { value } = this.props\n\n\t\t// `0` is not an empty value\n\t\tif (typeof value === 'number' && value === 0)\n\t\t{\n\t\t\treturn false\n\t\t}\n\n\t\t// An empty string, `undefined`, `null` –\n\t\t// all those are an empty value.\n\t\tif (!value)\n\t\t{\n\t\t\treturn true\n\t\t}\n\n\t\t// Whitespace string is also considered empty\n\t\tif (typeof value === 'string' && !value.trim())\n\t\t{\n\t\t\treturn true\n\t\t}\n\n\t\t// Not empty\n\t\treturn false\n\t}\n\n\t// Whether should indicate that the input value is invalid\n\tshould_indicate_invalid()\n\t{\n\t\tconst { indicateInvalid, error } = this.props\n\n\t\treturn indicateInvalid && error\n\t}\n\n\tautoresize = (event) =>\n\t{\n\t\tconst { autoresize } = this.props\n\n\t\tif (!autoresize)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst measurements = this.measurements()\n\t\tconst element = event ? event.target : ReactDOM.findDOMNode(this.input)\n\n\t\telement.style.height = 0\n\n\t\t// `element.scrollHeight` is always an integer\n\t\t// so it doesn't need rounding (e.g. `em`s).\n\t\tlet height = element.scrollHeight + measurements.extra_height\n\t\theight = Math.max(height, measurements.initial_height)\n\n\t\tif (get_modular_grid_unit() && height % get_modular_grid_unit())\n\t\t{\n\t\t\theight = Math.ceil(height / get_modular_grid_unit()) * get_modular_grid_unit()\n\t\t}\n\n\t\telement.style.height = height + 'px'\n\t}\n\n\ton_window_resize = throttle((event) =>\n\t{\n\t\tthis.autoresize()\n\t}, 100)\n\n\t// The underlying `input` component\n\t// can pass both `event`s and `value`s\n\t// to this parent `onChange` listener.\n\ton_change = (event) =>\n\t{\n\t\t// Extract `value` from the argument\n\t\t// of this `onChange` listener\n\t\t// (for convenience)\n\n\t\tlet value = event\n\n\t\tif (event.target !== undefined)\n\t\t{\n\t\t\tvalue = event.target.value\n\t\t}\n\n\t\t// Call the parent `onChange` handler\n\t\t// with the `value` as an argument\n\t\t// (for convenience)\n\n\t\tconst { onChange } = this.props\n\n\t\tonChange(value)\n\t}\n\n\ton_key_down = (event) =>\n\t{\n\t\tconst { onKeyDown } = this.props\n\n\t\t// Submit the form on Cmd + Enter (or Ctrl + Enter)\n\t\tif ((event.ctrlKey || event.metaKey) && event.keyCode === 13)\n\t\t{\n\t\t\tif (submit_parent_form(ReactDOM.findDOMNode(this.input)))\n\t\t\t{\n\t\t\t\tevent.preventDefault()\n\t\t\t}\n\t\t}\n\n\t\tif (onKeyDown)\n\t\t{\n\t\t\tonKeyDown(event)\n\t\t}\n\t}\n\n\tfocus()\n\t{\n\t\tconst { input } = this.props\n\n\t\t// For simple DOM nodes like `<input/>`\n\t\t// just focus on them.\n\t\tif (typeof input === 'string') {\n\t\t\treturn ReactDOM.findDOMNode(this.input).focus()\n\t\t}\n\n\t\t// For custom components call `.focus()` on them\n\t\t// (if available)\n\t\treturn this.input.focus && this.input.focus()\n\t}\n\n\tmeasure()\n\t{\n\t\treturn autoresize_measure(ReactDOM.findDOMNode(this.input))\n\t}\n\n\tmeasurements()\n\t{\n\t\tlet measurements = this.state.autoresize\n\n\t\t// If it's the first time accessing measurements,\n\t\t// or if the textarea was initially hidden\n\t\t// (like `display: none` for a mobile-oriented responsive design)\n\t\t// then make the initial measurements now.\n\t\tif (!measurements || !measurements.initial_height)\n\t\t{\n\t\t\tmeasurements = this.measure()\n\n\t\t\t// If the `<textarea/>` is not hidden (e.g. via `display: none`)\n\t\t\t// then keep its initial (minimum) height\n\t\t\t// so that it doesn't shrink below this value\n\t\t\tif (measurements.initial_height)\n\t\t\t{\n\t\t\t\tthis.setState({ autoresize: measurements })\n\t\t\t}\n\t\t}\n\n\t\treturn measurements\n\t}\n}\n\n// <textarea/> autoresize (without ghost elements)\n// https://github.com/javierjulio/textarea-autosize/blob/master/src/jquery.textarea_autosize.js\nfunction autoresize_measure(element)\n{\n\tconst style = window.getComputedStyle(element)\n\n\t// Borders extra height, because `.scrollHeight` doesn't include borders.\n\tconst extra_height =\n\t\tparseInt(style.borderTopWidth) +\n\t\tparseInt(style.borderBottomWidth)\n\n\t// `<textarea/>`'s height is a float when using `em`, `rem`, `pt`, etc.\n\tconst non_rounded_initial_height = element.getBoundingClientRect().height\n\tconst initial_height = Math.ceil(non_rounded_initial_height)\n\n\t// Round the height of `<textarea/>` so that it doesn't jump\n\t// when autoresizing while typing for the first time.\n\tif (initial_height !== non_rounded_initial_height)\n\t{\n\t\telement.style.height = initial_height + 'px'\n\t}\n\n\treturn { extra_height, initial_height }\n}\n"]}